#!/usr/bin/env ruby
require 'bundler/setup'
require 'commander/import'
require 'erb'
require 'singleton'
require 'yaml'
require 'pry'
require 'pry-remote'
require 'pry-nav'
require 'vagrantswissarmyknife/config'
require 'vagrantswissarmyknife/init'
require 'vagrantswissarmyknife/operations'
require 'vagrantswissarmyknife/version'

program :name, 'vagrant-swissarmyknife'
program :version, '1.0.0'
program :description, 'bakes beans on toast'

command :init do |cmd|
  cmd.syntax = 'vagrant-swissarmyknife init'
  cmd.description = 'Initializes the environment'
  cmd.action do
    initialize = VagrantSwissArmyKnife::Init.new
    operations = VagrantSwissArmyKnife::Operations.new
    initialize.install_templates
    initialize.install_polipo
    operations.start_polipo
    operations.set_proxy_env_variables
    initialize.bundler
    initialize.install_vagrant_plugins
    #initialize.download_vagrant_boxes
    #initialize.import_vagrant_boxes
  end
end


command :uninstall do |cmd|
  cmd.syntax = 'vagrant-swissarmyknife uninstall'
  cmd.description = 'uninstalls the components'
  cmd.action do
    initialize = VagrantSwissArmyKnife::Init.new
    initialize.uninstall
  end
end

command :up do |cmd|
  cmd.syntax = 'vagrant-swissarmyknife up'
  cmd.description = 'Executes vagrant up'
  cmd.action do
    operations = VagrantSwissArmyKnife::Operations.new
    operations.up
  end
end

command :provision do |cmd|
  cmd.syntax = 'vagrant-swissarmyknife provision'
  cmd.description = 'Executes vagrant provision'
  cmd.action do
    operations = VagrantSwissArmyKnife::Operations.new
    operations.provision
  end
end

command :destroy do |cmd|
  cmd.syntax = 'vagrant-swissarmyknife destroy'
  cmd.description = 'Executes vagrant destroy'
  cmd.action do
    operations = VagrantSwissArmyKnife::Operations.new
    operations.provision
  end
end
